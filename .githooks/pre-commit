#!/bin/sh
set -e

echo "Running dotnet format..."
cd src
dotnet format --verify-no-changes
if [ $? -ne 0 ]; then
  echo "Code is not formatted. Run 'dotnet format' before committing."
  exit 1
fi

echo "Running dotnet test..."
dotnet test --no-build --verbosity minimal
if [ $? -ne 0 ]; then
  echo "Tests failed. Fix them before committing."
  exit 1
fi
cd ..

git add .

echo "Pre-commit checks passed."
exit 0